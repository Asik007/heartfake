<html>
    <body>
        <style>
            
            body {
                margin: 0;    
            }
            #controls {
                z-index: 10;
                position: absolute;
            }
            #pulser {
                position: absolute;
                width: 100%;
                height: 100%;
                background: red;
                animation-name: pulser;
                animation-duration: 0.0s;
                animation-iteration-count: infinite;
                animation-direction: alternate;
            }
            @keyframes pulser {
                0%   {background-color: red;}
                37%   {background-color: red;}
                37.5%   {background-color: white;}
                100%   {background-color: white;}
            }
        </style>


        <div id="controls">
            <span id="BPM"> &ensp; 10</span>BPM
            <input value="10" min="1" max="200" oninput="setHertz(this)" type="range" step="1">
            <br>
            <br>
            <span id="A"> &ensp; 0</span>
            <input value="0" min="1" max="200" oninput="setA(this)" type="range" step="1">
            <input value = "0" min="1" max="200" oninput = "setA(this)" type = "number" step= "1"><br>
            <span id="B"> &ensp; 0</span>
            
            <input value="0" min="1" max="200" oninput="setB(this)" type="range" step="1"><input value = "0" min="1" max="200" oninput = "setB(this)" type = "number" step= "1"><br><span id="C"> &ensp; 0</span>
            <input value="0" min="1" max="200" oninput="setC(this)" type="range" step="1"><input value = "0" min="1" max="200" oninput = "setC(this)" type = "number" step= "1"><br><span id="D"> &ensp; 0</span>
            <input value="0" min="1" max="200" oninput="setD(this)" type="range" step="1"><input value = "0" min="1" max="200" oninput = "setF(this)" type = "number" step= "1"><br><span id="E"> &ensp; 0</span>
            <input value="0" min="1" max="200" oninput="setE(this)" type="range" step="1"><input value = "0" min="1" max="200" oninput = "setE(this)" type = "number" step= "1"><br><span id="F"> &ensp; 0</span>
            <input value="0" min="1" max="200" oninput="setF(this)" type="range" step="1"><input value = "0" min="1" max="200" oninput = "setF(this)" type = "number" step= "1"><br>
            <span id="R"> 0</span> <span>minutes</span>
            <input value="10" min="1" max="60" oninput="setR(this)" type="number"> <br>
            <button name="run" onclick="routine()" >run</button>
        <br>

            <button name ="idk" onclick = "findAllVariables()" > debugg</button>
            <pre><p style="font-family:courier new;font-size:15px">
            
            To set the routine use the sliders to set your average value.
            If you want to run it again refresh the page.
            Also, it takes 30 sec for the routine to actually start.
            The bottom box describes how long the routine will last.
        </pre></p>
            
        </div>
        <div id="pulser"></div>
        <script>
            var i = 0
                var slider = 0
                var select =0
                
                var time = 0
            
            function routine() {
                var A = parseInt(document.getElementById("A").innerHTML);
                var B = parseInt(document.getElementById("B").innerHTML);
                var C = parseInt(document.getElementById("C").innerHTML);
                var D = parseInt(document.getElementById("D").innerHTML);
                var E = parseInt(document.getElementById("E").innerHTML);
                var F = parseInt(document.getElementById("F").innerHTML);
                var R = (parseInt(document.getElementById("R").innerHTML));
                
                console.log(R);
                myLoop();
                
                
                function myLoop() { 
                    var A = parseInt(document.getElementById("A").innerHTML);
                    var B = parseInt(document.getElementById("B").innerHTML);
                    var C = parseInt(document.getElementById("C").innerHTML);
                    var D = parseInt(document.getElementById("D").innerHTML);
                    var E = parseInt(document.getElementById("E").innerHTML);
                    var F = parseInt(document.getElementById("F").innerHTML);
                    var R = (parseInt(document.getElementById("R").innerHTML));
                            
                setTimeout(function() {   //  call a 3s setTimeout when the loop is called
                    if(slider >= 6){
                    return
                }    
                    console.log('count');   //  your code here
                        i++;                    //  increment the counter
                        if (i <= R) {           //  if the counter < 10, call the loop function
                            myLoop();
                            console.log(i);  
                        } 
                        else{
                            myLoop();
                            i = 0
                            slider++
                            console.log("idk");
                        }
                        console.log(slider);
                        if(slider >= 6){
                            setFreq(0); 
                            return
                        }
                        switch(slider){
                    case 0:
                        select = A;
                        break;
                        
                    case 1:
                        select = B;
                        break;
                        
                    case 2:
                        select = C;
                        break;
                        
                    case 3:
                        select = D;
                        break;
                        
                    case 4:
                        select = E;
                        break;
                        
                    case 5:
                        select = F;
                        break;
                        }
                        console.log(select)

                        time = Math.round((Math.random()*20)+(select-10))
                        setFreq(time);
                        console.log(time)
                    }, 30000)
                }
            }
            
            
            function setA(ele) {
                var A = ele.value;
                document.getElementById('A').innerText = A;
            }
            function setB(ele) {
                var A = ele.value;
                document.getElementById('B').innerText = A;
            }
            function setC(ele) {
                var A = ele.value;
                document.getElementById('C').innerText = A;
            }
            function setD(ele) {
                var A = ele.value;
                document.getElementById('D').innerText = A;
            }
            function setE(ele) {
                var A = ele.value;
                document.getElementById('E').innerText = A;
            }
            function setF(ele) {
                var A = ele.value;
                document.getElementById('F').innerText = A;
            }
            function setR(ele) {
                var A = ele.value;
                document.getElementById('R').innerText = A;
                console.log(A)
            }
            function setHertz(ele) {
                var BPM = ele.value;
                document.getElementById('BPM').innerText = BPM;
                var seconds = 1 / ((parseInt(BPM))/60) / 2;
                
                console.log(seconds)
               document.getElementById('pulser').style.animationDuration = seconds + 's'
            }
            function setFreq(ele) {
                
                var BPM = ele;
                
                console.log(BPM);
                document.getElementById('BPM').innerText = BPM;
                var seconds = 1 / ((parseInt(BPM))/60) / 2;
                
                if(slider >= 6){
                    document.getElementById('pulser').style.animationDuration = '0s'
                    
                }
                console.log(seconds)
               document.getElementById('pulser').style.animationDuration = seconds + 's'
                
            }
        
        </script>
        
        
    </body>
</html>
